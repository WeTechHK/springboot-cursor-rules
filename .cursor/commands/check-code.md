# /check-code 命令

## 命令格式
```bash
/check-code [一段描述性的话]
```

## 功能说明
检查代码质量，包括编码规范、设计模式、性能优化、安全编码和最佳实践。

## AI分析流程

### 1. 智能描述解析
- **提取关键信息**：从用户描述中提取检查类型、检查范围、检查需求
- **识别检查类型**：判断是规范检查、性能检查、安全检查、设计检查等
- **推断检查复杂度**：评估检查的复杂度和检查深度

### 2. 智能文档发现
- **自动扫描**：扫描项目根目录下的`docs/`目录中的编码规范文档、质量文档、检查文档
- **内容匹配**：基于描述内容匹配相关规范文档
- **信息提取**：从文档中提取编码规范、质量标准、检查规则等
- **文件显示**：在AI响应中显示找到的相关设计文件名，便于用户确认

### 3. 基于项目结构的智能推断
- **项目分析**：分析现有项目的代码风格、架构设计、技术栈
- **规范识别**：识别相关编码规范和最佳实践
- **规范推断**：推断项目的代码质量标准

### 4. 代码检查规则匹配
- **规范匹配**：根据需求匹配对应的代码检查规范
- **检查模式**：应用代码检查模式和最佳实践
- **检查生成**：生成符合项目规范的代码检查报告

### 5. 主动询问机制
- **检查补全**：识别缺失或模糊的检查需求，主动询问用户
- **范围确认**：确认检查范围和检查深度
- **多轮对话**：支持多轮对话，逐步完善检查需求

## 使用示例

### 1. 简单描述
```bash
/check-code 检查用户管理模块代码质量
```

### 2. 详细描述
```bash
/check-code 检查用户管理模块代码质量，包括编码规范、性能优化、安全编码
```

### 3. 业务场景描述
```bash
/check-code 检查订单管理模块，重点关注事务处理、异常处理、数据校验
```

### 4. 技术需求描述
```bash
/check-code 检查整个项目的代码质量，包括架构设计、性能优化、安全编码
```

## AI交互示例

### 示例1：简单描述
```bash
# 用户输入
/check-code 检查用户管理模块代码质量

# AI响应
AI: 已解析您的描述"检查用户管理模块代码质量"，基于项目结构和编码规范，我将进行以下检查：

**发现的设计文档：**
- `docs/coding-standards.md` - 编码规范文档
- `docs/code-quality-standards.md` - 代码质量标准文档
- `docs/user-module-design.md` - 用户模块设计文档

**推断的检查范围：**
- UserController - 控制器层检查
- UserService - 服务层检查
- UserMapper - 数据访问层检查
- UserEntity - 实体类检查
- UserRequest/Response - DTO检查

**推断的检查项目：**
- 编码规范符合性
- 命名规范符合性
- 注解使用规范性
- 异常处理完整性
- 日志记录规范性

**需要确认的信息：**
基于您的描述，我将智能判断是否需要确认信息：

- **如果描述完整**：直接开始代码检查
- **如果缺少检查范围**：询问具体的检查文件和目录
- **如果缺少检查类型**：询问具体的检查类型和重点
- **如果缺少检查深度**：询问检查的详细程度和报告格式
- **如果描述模糊**：询问关键检查需求

**当前状态：** 基于您的描述，我将智能选择检查范围和类型，如有疑问会主动询问。
```

### 示例2：详细描述
```bash
# 用户输入
/check-code 检查用户管理模块代码质量，包括编码规范、性能优化、安全编码

# AI响应
AI: 已解析您的详细描述，将对用户管理模块进行全面的代码质量检查：

**发现的设计文档：**
- `docs/coding-standards.md` - 编码规范文档
- `docs/code-quality-standards.md` - 代码质量标准文档
- `docs/user-module-design.md` - 用户模块设计文档
- `docs/performance-standards.md` - 性能优化标准文档
- `docs/security-standards.md` - 安全编码标准文档

**检查范围：**
- UserController - 控制器层
- UserService/UserServiceImpl - 服务层
- UserMapper - 数据访问层
- UserEntity - 实体类
- UserRequest/UserResponse - DTO类

**检查项目：**
1. 编码规范检查
   - 命名规范符合性
   - 代码格式规范性
   - 注解使用规范性
   - 注释完整性

2. 性能优化检查
   - 数据库查询优化
   - 缓存使用合理性
   - 事务管理优化
   - 内存使用优化

3. 安全编码检查
   - 参数校验完整性
   - SQL注入防护
   - 敏感信息处理
   - 权限控制检查

**需要确认的信息：**
基于您的详细描述，我发现以下信息：

✅ **已明确**：用户管理模块、代码质量检查、规范符合性
✅ **检查范围**：Controller、Service、Entity、Mapper类
✅ **检查类型**：代码规范、性能、安全、架构检查

**执行决策：** 信息完整，直接开始全面的代码质量检查
```

## 检查内容

### 1. 编码规范检查
- **命名规范**: 类名、方法名、变量名符合规范
- **代码格式**: 缩进、空格、换行符合规范
- **注解使用**: 注解使用正确和完整
- **注释规范**: JavaDoc注释完整和规范

### 2. 架构设计检查
- **分层架构**: 符合MVC分层架构
- **依赖注入**: 使用@Autowired字段注入
- **设计模式**: 应用合适的设计模式
- **职责分离**: 各层职责清晰分离

### 3. 性能优化检查
- **数据库查询**: 避免N+1查询问题
- **缓存使用**: 合理使用缓存策略
- **事务管理**: 事务边界合理设置
- **内存使用**: 避免内存泄漏和过度使用

### 4. 安全编码检查
- **参数校验**: 完整的参数校验
- **SQL注入**: 使用预编译SQL
- **敏感信息**: 敏感信息脱敏处理
- **权限控制**: 完整的权限控制

### 5. 异常处理检查
- **异常捕获**: 完整的异常捕获
- **异常处理**: 合理的异常处理策略
- **错误码**: 使用统一的错误码
- **日志记录**: 完整的日志记录

## 检查报告

### 1. 检查结果
- **通过项目**: 符合规范的代码
- **警告项目**: 需要改进的代码
- **错误项目**: 不符合规范的代码
- **建议项目**: 优化建议

### 2. 问题分类
- **规范问题**: 编码规范不符合
- **性能问题**: 性能优化建议
- **安全问题**: 安全编码问题
- **设计问题**: 架构设计问题

### 3. 优化建议
- **具体建议**: 针对性的优化建议
- **代码示例**: 优化后的代码示例
- **最佳实践**: 相关的最佳实践
- **参考文档**: 相关的规范文档

## 检查特性
1. **全面性**: 覆盖代码的各个方面
2. **准确性**: 基于项目规范进行检查
3. **实用性**: 提供具体的优化建议
4. **可操作性**: 提供可执行的改进方案
5. **学习性**: 帮助开发者学习最佳实践

## 技术实现
- **规范匹配**: 基于项目编码规范进行检查
- **静态分析**: 分析代码结构和逻辑
- **模式识别**: 识别设计模式和最佳实践
- **问题定位**: 准确定位代码问题
- **建议生成**: 生成具体的优化建议

## 注意事项
1. AI会根据描述自动推断检查范围
2. 自动分析代码质量和规范符合性
3. 提供详细的检查报告和优化建议
4. 基于项目的编码规范和最佳实践
5. 支持多轮对话完善检查需求
6. 支持文档引用和智能推断
7. 支持自然语言描述

## 最佳实践建议

### 1. 描述技巧
- **具体描述**: 提供详细的检查需求描述，AI能更好地理解需求
- **检查范围**: 明确检查的文件和模块
- **检查重点**: 指定重点检查的方面

### 2. 交互技巧
- **分步确认**: 先确认检查范围，再完善检查细节
- **及时反馈**: 对AI的检查结果及时提供反馈
- **迭代优化**: 基于检查结果进行迭代优化

### 3. 文档使用
- **规范文档**: 在项目中维护编码规范文档，AI会自动发现
- **质量文档**: 维护代码质量文档，AI会参考进行检查
- **最佳实践文档**: 维护最佳实践文档，AI会参考生成建议