# /format-code 命令

## 命令格式
```bash
/format-code [一段描述性的话]
```

## 功能说明
格式化代码，包括代码格式化、导入语句整理、代码风格统一、注释格式规范和代码布局优化。

## AI分析流程

### 1. 智能描述解析
- **提取关键信息**：从用户描述中提取代码范围、格式化需求、风格要求
- **识别格式化类型**：判断是代码格式化、导入整理、注释规范、布局优化等
- **推断格式化复杂度**：基于描述推断格式化的复杂度和影响范围

### 2. 智能文档发现
- **自动扫描**：扫描项目根目录下的`docs/`目录中的代码规范文档、风格文档、格式化文档
- **内容匹配**：基于描述内容匹配相关代码规范文档
- **信息提取**：从文档中提取代码规范、格式化规则、风格标准等
- **文件显示**：在AI响应中显示找到的相关设计文件名，便于用户确认

### 3. 基于项目结构的智能推断
- **项目分析**：分析现有项目的代码风格、格式化规范、编码标准
- **规范识别**：识别相关代码规范和格式化规则
- **规范推断**：推断项目的代码格式化规范

### 4. 代码格式化规则匹配
- **规范匹配**：根据需求匹配对应的代码格式化规范
- **格式化策略**：应用代码格式化策略和最佳实践
- **代码生成**：生成符合项目规范的格式化代码

### 5. 主动询问机制
- **范围补全**：识别缺失或模糊的格式化范围，主动询问用户
- **规范确认**：确认格式化规范和风格要求
- **多轮对话**：支持多轮对话，逐步完善格式化方案

## 使用示例

### 1. 简单描述
```bash
/format-code 格式化用户管理模块代码
```

### 2. 详细描述
```bash
/format-code 格式化用户管理模块代码，统一代码风格和注释格式
```

### 3. 业务场景描述
```bash
/format-code 格式化整个项目的Java代码，包括导入语句整理和注释规范
```

### 4. 技术需求描述
```bash
/format-code 格式化当前文件的代码，优化代码布局和可读性
```

## AI交互示例

### 示例1：简单描述
```bash
# 用户输入
/format-code 格式化用户管理模块代码

# AI响应
AI: 已解析您的描述"格式化用户管理模块代码"，并发现以下相关文档：

**发现的设计文档：**
- `docs/code-style-standards.md` - 代码风格标准文档
- `docs/formatting-rules.md` - 格式化规则文档
- `docs/user-module-design.md` - 用户模块设计文档

基于这些文档，将对以下代码进行格式化：

**推断的格式化范围：**
- UserController - 控制器类格式化
- UserService - 服务类格式化
- UserMapper - 数据访问类格式化
- UserEntity - 实体类格式化

**需要确认的信息：**
1. 需要格式化哪些具体文件？
2. 是否需要统一代码风格？
3. 是否需要整理导入语句？
4. 是否需要规范注释格式？
5. 是否需要优化代码布局？

请提供详细信息，或者确认我的推断是否正确？
```

### 示例2：详细描述
```bash
# 用户输入
/format-code 格式化用户管理模块代码，统一代码风格和注释格式

# AI响应
AI: 已解析您的详细描述，将对用户管理模块进行代码格式化：

**发现的设计文档：**
- `docs/code-style-standards.md` - 代码风格标准文档
- `docs/formatting-rules.md` - 格式化规则文档
- `docs/user-module-design.md` - 用户模块设计文档

**解析的格式化方案：**
1. 代码风格统一
   - 统一缩进和空格
   - 统一大括号风格
   - 统一换行符
   - 统一命名风格

2. 注释格式规范
   - JavaDoc注释规范
   - 行内注释规范
   - 注释内容规范
   - 注释位置规范

3. 导入语句整理
   - 导入语句排序
   - 未使用导入清理
   - 导入语句分组
   - 通配符导入处理

**需要确认的信息：**
1. 具体的格式化规则？
2. 是否需要保持原有功能？
3. 是否需要格式化测试代码？
4. 是否需要格式化配置文件？

请确认以上信息是否正确，或者提供更多详细信息？
```

## 格式化内容

### 1. 代码格式化
- 统一的代码格式
- 规范的缩进和空格
- 统一的代码风格
- 规范的注释格式

### 2. 导入语句整理
- 导入语句排序
- 未使用导入清理
- 导入语句分组
- 通配符导入处理

### 3. 代码风格统一
- 大括号风格统一
- 空格使用统一
- 换行符统一
- 命名风格统一

### 4. 注释格式规范
- JavaDoc注释规范
- 行内注释规范
- 注释内容规范
- 注释位置规范

### 5. 代码布局优化
- 方法布局优化
- 类布局优化
- 包布局优化
- 文件布局优化

## 代码范围类型

### 1. 模块格式化
- `UserModule` - 用户管理模块
- `OrderModule` - 订单管理模块
- `ProductModule` - 商品管理模块
- `PaymentModule` - 支付管理模块

### 2. 文件类型格式化
- `JavaFiles` - Java源文件
- `ConfigFiles` - 配置文件
- `TestFiles` - 测试文件
- `ResourceFiles` - 资源文件

### 3. 代码层级格式化
- `ControllerLayer` - 控制器层
- `ServiceLayer` - 服务层
- `MapperLayer` - 数据访问层
- `EntityLayer` - 实体层

### 4. 特定功能格式化
- `ImportStatements` - 导入语句
- `Comments` - 注释格式
- `CodeLayout` - 代码布局
- `NamingConventions` - 命名规范

## 格式化特性
1. **一致性**: 统一的代码格式风格
2. **可读性**: 提高代码可读性
3. **可维护性**: 便于代码维护
4. **标准化**: 符合编码规范
5. **自动化**: 自动化格式化处理

## 技术实现
- **工具**: 使用代码格式化工具
- **规则**: 基于编码规范规则
- **配置**: 格式化配置文件
- **验证**: 格式化结果验证
- **文档**: 格式化说明文档

## 注意事项
1. AI会根据描述自动推断格式化范围
2. 自动分析代码风格和格式化需求
3. 提供具体的格式化实施方案
4. 遵循项目的编码规范和代码风格
5. 生成的代码可以直接运行和测试
6. 支持多轮对话完善需求
7. 支持文档引用和智能推断
8. 支持自然语言描述

## 最佳实践建议

### 1. 描述技巧
- **具体描述**: 提供详细的格式化需求描述，AI能更好地理解需求
- **关键范围**: 包含具体的代码范围和格式化要求
- **风格要求**: 指定代码风格和格式化标准

### 2. 交互技巧
- **分步确认**: 先确认核心范围，再完善格式化细节
- **及时反馈**: 对AI的推断及时提供反馈
- **迭代优化**: 基于格式化结果进行迭代改进

### 3. 文档使用
- **规范文档**: 在项目中维护代码规范文档，AI会自动发现
- **风格文档**: 维护代码风格文档，AI会参考进行格式化
- **格式化文档**: 维护格式化文档，AI会参考生成格式化方案