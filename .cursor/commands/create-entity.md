# /create-entity 命令

## 命令格式
```bash
/create-entity [一段描述性的话]
```

## 功能说明
创建MyBatis实体类，包括实体类定义、字段映射和注解、数据校验注解、序列化配置和数据库表映射。

## AI分析流程

### 1. 智能描述解析
- **提取关键信息**：从用户描述中提取实体名称、字段信息、业务需求
- **识别实体类型**：判断是业务实体、配置实体、日志实体等
- **推断字段类型**：基于描述推断合适的字段类型和约束

### 2. 智能文档发现
- **自动扫描**：扫描项目根目录下的`docs/`目录中的数据库文档、表结构文档、实体设计文档
- **内容匹配**：基于描述内容匹配相关数据库文档
- **信息提取**：从文档中提取表结构、字段定义、约束条件等
- **文件显示**：在AI响应中显示找到的相关设计文件名，便于用户确认

### 3. 基于项目结构的智能推断
- **项目分析**：分析现有项目的实体设计风格、数据库设计
- **表结构识别**：识别相关表结构和字段规范
- **规范推断**：推断项目的实体设计规范

### 4. 实体类规则匹配
- **规范匹配**：根据需求匹配对应的实体类编码规范
- **设计模式**：应用实体设计模式和最佳实践
- **代码生成**：生成符合项目规范的实体类代码

### 5. 主动询问机制
- **字段补全**：识别缺失或模糊的字段需求，主动询问用户
- **类型确认**：确认字段类型和约束条件
- **多轮对话**：支持多轮对话，逐步完善实体设计

## 使用示例

### 1. 简单描述
```bash
/create-entity 用户实体
```

### 2. 详细描述
```bash
/create-entity 用户实体，包含ID、用户名、邮箱、密码、状态、创建时间、更新时间
```

### 3. 业务场景描述
```bash
/create-entity 商品实体，包含商品名称、价格、库存、分类、状态、描述、图片
```

### 4. 技术需求描述
```bash
/create-entity 订单实体，包含订单号、用户ID、商品ID、数量、金额、状态、支付时间
```

## AI交互示例

### 示例1：简单描述
```bash
# 用户输入
/create-entity 用户实体

# AI响应
AI: 已解析您的描述"用户实体"，并发现以下相关文档：

**发现的设计文档：**
- `docs/database-design.md` - 数据库设计文档
- `docs/user-table-schema.md` - 用户表结构文档
- `docs/entity-design.md` - 实体类设计文档

基于这些文档，UserEntity将包含以下字段设计：

**推断的基础字段：**
- id (Long) - 主键ID
- createTime (Timestamp) - 创建时间
- updateTime (Timestamp) - 更新时间
- isDeleted (Boolean) - 是否删除

**推断的业务字段：**
- username (String) - 用户名
- email (String) - 邮箱
- password (String) - 密码
- status (String) - 状态

**需要确认的信息：**
基于您的描述，我将智能判断是否需要确认信息：

- **如果描述完整**：直接开始生成Entity实体类
- **如果缺少字段信息**：询问核心业务字段和数据类型
- **如果缺少约束规则**：询问唯一约束和验证规则
- **如果缺少关联关系**：询问实体间的关联关系
- **如果描述模糊**：询问关键字段细节

**当前状态：** 基于您的描述，我将智能推断实体字段和约束规则，如有疑问会主动询问。
```

### 示例2：详细描述
```bash
# 用户输入
/create-entity 用户实体，包含ID、用户名、邮箱、密码、状态、创建时间、更新时间

# AI响应
AI: 已解析您的详细描述，UserEntity将包含以下字段：

**发现的设计文档：**
- `docs/database-design.md` - 数据库设计文档
- `docs/user-table-schema.md` - 用户表结构文档
- `docs/entity-design.md` - 实体类设计文档

**解析的字段：**
- id (Long) - 主键ID，自增
- username (String) - 用户名，唯一约束
- email (String) - 邮箱，唯一约束
- password (String) - 密码，加密存储
- status (String) - 状态，默认值"ACTIVE"
- createTime (Timestamp) - 创建时间，自动填充
- updateTime (Timestamp) - 更新时间，自动更新

**推断的注解：**
- @Data, @NoArgsConstructor, @AllArgsConstructor, @Builder
- @Table(name = "t_users")
- @NotNull, @NotBlank, @Size, @Email

**推断的数据库表：**
- 表名：t_users
- 主键：id (BIGINT AUTO_INCREMENT)
- 唯一索引：username, email
- 普通索引：status, create_time

**需要确认的信息：**
基于您的详细描述，我发现以下信息：

✅ **已明确**：用户实体字段、数据类型、约束规则
✅ **字段设计**：用户名、邮箱、密码、状态等核心字段
✅ **技术规范**：MyBatis注解、数据校验、审计字段

**执行决策：** 信息完整，直接开始生成用户Entity实体类
```

## 生成内容

### 1. 实体类 (Entity)
- 类名以`Entity`结尾
- 使用Lombok注解简化代码
- 包含所有必要的字段
- 完整的JavaDoc注释

### 2. 字段定义
- 根据字段描述生成相应字段
- 基础字段（ID、创建时间、更新时间）
- 业务字段（根据描述生成）
- 状态字段和枚举字段

### 3. Lombok注解
- `@Data` - 自动生成getter/setter方法
- `@NoArgsConstructor` - 无参构造器
- `@AllArgsConstructor` - 全参构造器
- `@Builder` - 建造者模式支持

### 4. 数据校验注解
- `@NotNull` - 非空校验
- `@NotBlank` - 非空白校验
- `@Size` - 长度校验
- `@Email` - 邮箱格式校验
- `@Pattern` - 正则表达式校验

### 5. 数据库映射
- `@Table` - 数据库表映射
- `@Column` - 字段映射
- `@Id` - 主键标识
- `@GeneratedValue` - 主键生成策略

## 标准字段类型

### 1. 基础字段
- `id` - 主键ID (Long类型)
- `createTime` - 创建时间 (Timestamp类型)
- `updateTime` - 更新时间 (Timestamp类型)
- `isDeleted` - 是否删除 (Boolean类型)

### 2. 业务字段
- 字符串字段 - 使用String类型
- 数值字段 - 使用Integer、Long、BigDecimal类型
- 日期字段 - 使用Timestamp类型
- 布尔字段 - 使用Boolean类型，is前缀命名

### 3. 状态字段
- 状态字段 - 使用String或枚举类型
- 金额字段 - 使用BigDecimal类型
- 枚举字段 - 使用枚举类型

## 实体类特性
1. **简化代码**: 使用Lombok注解简化代码
2. **数据校验**: 完整的字段校验注解
3. **序列化**: 支持JSON序列化和反序列化
4. **数据库映射**: 完整的数据库表映射
5. **可维护**: 清晰的代码结构和注释

## 技术实现
- **注解**: 使用Lombok、JPA、Validation注解
- **序列化**: 支持Jackson序列化配置
- **校验**: 使用Bean Validation进行数据校验
- **映射**: 数据库表字段映射
- **构建**: 支持Builder模式构建对象

## 注意事项
1. AI会根据描述自动推断实体字段
2. 自动处理数据库表名和字段映射
3. 包含完整的数据校验注解
4. 遵循项目的编码规范和数据库设计
5. 生成的代码可以直接运行和测试
6. 支持多轮对话完善需求
7. 支持文档引用和智能推断
8. 支持自然语言描述

## 最佳实践建议

### 1. 描述技巧
- **具体描述**: 提供详细的字段描述，AI能更好地理解需求
- **关键字段**: 包含核心业务字段，帮助AI生成准确代码
- **约束条件**: 指定字段约束和校验规则

### 2. 交互技巧
- **分步确认**: 先确认核心字段，再完善字段细节
- **及时反馈**: 对AI的推断及时提供反馈
- **迭代优化**: 基于生成结果进行迭代优化

### 3. 文档使用
- **数据库文档**: 在项目中维护数据库文档，AI会自动发现
- **表结构文档**: 维护表结构文档，AI会参考生成实体
- **字段文档**: 维护字段文档，AI会参考生成字段定义